(function(e){function t(t){for(var a,i,r=t[0],c=t[1],l=t[2],d=0,p=[];d<r.length;d++)i=r[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&p.push(n[i][0]),n[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],a=!0,r=1;r<s.length;r++){var c=s[r];0!==n[c]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=s[0]))}return e}var a={},n={app:0},o=[];function i(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=a,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=c;o.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"1ca1":function(e,t,s){},2395:function(e,t,s){},"555a":function(e,t,s){e.exports=s.p+"img/icon.702b4617.png"},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("img",{staticClass:"logo",attrs:{alt:"logo",src:s("555a")}}),a("YoloUpload")],1)},o=[],i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"card"},[s("el-upload",{ref:"upload",attrs:{drag:"",action:e.api,"auto-upload":!0,accept:".jpg, .jpeg, .png","on-success":e.onSuccess,"show-file-list":!1,name:e.filename,"before-upload":e.handleSubmit,"on-remove":e.cleanImg,"on-change":e.handleImage}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[e._v("将图片拖到此处，或"),s("em",[e._v("点击上传")])])]),s("br"),s("el-button",{attrs:{icon:"el-icon-delete",size:"medium",round:""},on:{click:e.cleanImg}},[e._v("清空")])],1),e.showRes?s("div",[s("el-divider"),s("section",{staticClass:"cropper"},[s("vue-cropper",{ref:"cropper",attrs:{src:e.img,zoomable:!1,scalable:!1,movable:!1,zoomOnWheel:!1}})],1),s("el-dialog",{attrs:{title:"编辑",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("vue-cropper",{ref:"edit",attrs:{src:e.img,imgStyle:{height:"500px"}}}),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{round:""},on:{click:e.cropImage}},[e._v("截取并搜索")])],1)],1),s("el-row",{attrs:{type:"flex",justify:"space-around",gutter:20}},[s("el-col",{attrs:{span:14}},[e.img?s("img",{staticClass:"src-img",attrs:{src:e.img,alt:"原图片"}}):e._e(),s("br"),s("span",{staticStyle:{"font-weight":"500","font-size":"22px"}},[e._v("原图片")]),s("br"),s("el-button",{attrs:{icon:"el-icon-edit",round:"",size:"small"},on:{click:e.editImage}},[e._v("自定义")])],1),s("el-col",{attrs:{span:3}}),0!==e.ImgList.length?s("el-col",{attrs:{span:8}},e._l(e.detectObjects,(function(t,a){return s("el-row",{key:a,staticStyle:{"margin-bottom":"20px","margin-left":"50px"}},[s("div",{staticClass:"result"},[s("el-badge",{attrs:{value:t.confidence.toFixed(3),type:"success"}},[s("img",{staticClass:"result-image",attrs:{src:e.getImage(a),alt:t.class}})]),s("br"),s("em",[e._v(" "+e._s(t.class)+" ")]),s("el-button",{attrs:{icon:"el-icon-search",circle:"",size:"mini"},on:{click:function(t){return e.searchImg(a)}}}),s("el-divider")],1)])})),1):e._e(),s("el-col",{attrs:{span:3}})],1)],1):e._e()])},r=[],c=(s("ace4"),s("d3b7"),s("3ca3"),s("466d"),s("5319"),s("1276"),s("5cc6"),s("9a8c"),s("a975"),s("735e"),s("c1ac"),s("d139"),s("3a7b"),s("d5d6"),s("82f8"),s("e91f"),s("60bd"),s("5f96"),s("3280"),s("3fcc"),s("ca91"),s("25a1"),s("cd26"),s("3c5d"),s("2954"),s("649e"),s("219c"),s("170b"),s("b39a9"),s("72f7"),s("ddb0"),s("2b3d"),s("95c3")),l=s.n(c),u=(s("6107"),{name:"YoloUpload",components:{VueCropper:l.a},data:function(){return{api:"http://10.20.184.64:8000/upload/",showRes:!1,filename:"images",img:null,ImgList:[],dialogVisible:!1,detectObjects:[]}},methods:{handleSubmit:function(){this.$message({type:"success",message:"上传到华为ModelArt",duration:1500,center:!0})},handleImage:function(e){var t=URL.createObjectURL(e.raw);this.img=t,this.showRes=!0,this.$refs.cropper&&this.$refs.cropper.replace(t)},onSuccess:function(e){this.ImgList=[],this.detectObjects=JSON.parse(e),0!==this.detectObjects.length?(this.$message({type:"success",message:"成功检测到".concat(this.detectObjects.length,"个目标"),duration:1500,center:!0}),this.cropResultImage()):this.$message.error("未检测到目标")},cropResultImage:function(){for(var e=0;e<this.detectObjects.length;e++){var t=Math.min(this.detectObjects[e].box[2],this.detectObjects[e].box[3]),s=Math.min(this.detectObjects[e].box[0],this.detectObjects[e].box[1]),a=Math.abs(this.detectObjects[e].box[0]-this.detectObjects[e].box[1]),n=Math.abs(this.detectObjects[e].box[2]-this.detectObjects[e].box[3]);this.$refs.cropper.setCropBoxData({left:t,top:s,width:n,height:a}),this.ImgList.push(this.$refs.cropper.getCroppedCanvas().toDataURL())}},getImage:function(e){return this.ImgList[e]},searchImg:function(e){var t=new FormData;t.append("encoded_image",this.dataURLtoBlob(this.getImage(e)),"image.png");var s=this.$loading();fetch("https://www.google.com/searchbyimage/upload",{referrer:"",mode:"cors",method:"POST",body:t}).then((function(e){window.open(e.url),s.close()}))},dataURLtoBlob:function(e){var t=e.split(","),s=t[0].match(/:(.*?);/)[1],a=atob(t[1]),n=a.length,o=new Uint8Array(n);while(n--)o[n]=a.charCodeAt(n);return new Blob([o],{type:s})},cropImage:function(){this.$message({type:"success",message:"保存并搜索图片",duration:1500,center:!0}),this.ImgList.push(this.$refs.edit.getCroppedCanvas().toDataURL()),this.searchImg(this.ImgList.length-1),this.dialogVisible=!1},editImage:function(){this.dialogVisible=!0},cleanImg:function(){this.$message({type:"success",message:"清除图片",duration:1500,center:!0}),this.img=null,this.ImgList=[],this.showRes=!1}}}),d=u,p=(s("c220"),s("998b"),s("2877")),f=Object(p["a"])(d,i,r,!1,null,"29e0b088",null),h=f.exports,g={name:"app",components:{YoloUpload:h},data:function(){return{}}},m=g,b=(s("7c55"),Object(p["a"])(m,n,o,!1,null,null,null)),v=b.exports,w=s("5c96"),y=s.n(w),O=s("bc3a"),j=s.n(O),x=s("a7fe"),I=s.n(x);s("0fae");a["default"].use(y.a),j.a.defaults.withCredentials=!1,j.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",a["default"].use(I.a,j.a),a["default"].config.productionTip=!1,new a["default"]({render:function(e){return e(v)}}).$mount("#app")},"7c55":function(e,t,s){"use strict";var a=s("2395"),n=s.n(a);n.a},"998b":function(e,t,s){"use strict";var a=s("b24f"),n=s.n(a);n.a},b24f:function(e,t,s){},c220:function(e,t,s){"use strict";var a=s("1ca1"),n=s.n(a);n.a}});
//# sourceMappingURL=app.69718f1c.js.map